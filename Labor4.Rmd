---
title: "Mokslinio straipsnio analizė"
author: "Arina Vysockaja, Marija Sergejeva, Ignas Virbalas"
output: pdf_document
date: "2025-12-09"
---

```{r echo=FALSE, warning=FALSE, include = FALSE}
# Uzkrauname paketus
# echo = FALSE -- nurodo, kad kodas nespausdinamas ataskaitoje, bet spausdinami rezultatai
# warning = FALSE -- nurodo, kad warnings nespausdinami ataskaitoje
# include = FALSE -- nurodo, kad nei kodas nei rezultatai nespausdinami ataskaitoje
library(WDI)
library(dplyr)
library(ggplot2)
library(GGally)
```

```{r setup, include=FALSE} 
# Alternatyvus budas nuimti warningsus visame dokumente:
# 
# https://stackoverflow.com/questions/45399587/how-to-remove-warning-messages-in-r-markdown-document
# 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) #sueikia formule ir nespausidina warningu i console
```
# Nagrinėjamo straipsnio aprašymas

## Pavadinimas
“Impact of energy consumption and economic growth on CO2 emission using multivariate regression”

## Nuoroda į straipsnį
https://www.sciencedirect.com/science/article/pii/S2211467X19301208

## Straipsnio autoriai
Mostafa K. Ardakani, Seyed Mohsen Seyedaliakbar

## Žurnalo pavadinimas
Energy Strategy Reviews, Volume 26, 2019.
Nuoroda į žurnalą: https://www.sciencedirect.com/journal/energy-strategy-reviews/vol/26/suppl/C.  

---

# Tyrimo tikslai: 
- Ištirti sąryšį tarp energijos suvartojimo, ekonominio augimo ir CO2 emisijos EKC kontekste naudojant multivariacinę regresijos metodiką.
- Tyrime analizuojamos septynios valstybės Vidurio Rytų ir Šiaurės Afrikos regione, kurios pasižymi gausiais naftos ištekliais. 

## Tyrimo uždaviniai:  

- Panaudoti multivariacinę tiesinę regresijos metodika tam, kad būtų patvirtinta EKC hipotezė atliekamo tyrimo kontekste.  
- Pateikti atlikto tyrimo išvadas ir pasiūlymus remiantis gautais rezultatais.  

## Straipsnio tyrime naudoti duomenys:
- Duomenys surinkti iš World Bank Development Indicators, WDI. Filtruotas 1995 – 2014 metų laikotarpis, atrinktos 7 valstybės: Alžyras, Bahrainas, Iranas, Kuveitas, Omanas, Kataras ir Saudo Arabija. Pasirinkti valstybių kintamieji nurodytam periodui: CO2 emisijos (metrinės tonos vienam gyventojui), elektros energijos suvartojimas EPC (kWh vienam gyventojui) ir BVP vienam gyventojui (US$).  

## Mokslinio straipsnio autorių atliktos analizės metodai:  

---

### Modelio formulavimas ir diskriptyvinė analizė

Moksliniame straipsnyje, naudojant duomenis iš WDI duomenų bazės, CO$_2$ išmetimui taikoma tokia kvadratinė lygtis (kvadratinė regresija):
\[
\ln(\text{CO}_{2,it}) = b_{0i} + b_{1i} \cdot \ln(\text{EPC}_{it}) + b_{2i} \cdot \ln(\text{GDP}_{it}) + b_{3i} \cdot \left[\ln(\text{GDP}_{it})\right]^2 + \varepsilon_{it}
\]
EKC hipotezė tirta naudojant scenarijus, susijusius su BVP ir CO$_2$ išmetimu:

- (a) kai $b_{2i} \neq 0$ ir $b_{3i} < 0$  
  (gaunamas apverstas U formos ryšys tarp BVP ir CO$_2$ išmetimų)

- (b) kai $b_{2i} \neq 0$ ir $b_{3i} > 0$  
  (gaunamas U formos ryšys tarp BVP ir CO$_2$ išmetimų)

(a) atveju emisijos didėja iki tam tikro pajamų lygio (lūžio taško: $-\frac{0.5 b_{2i}}{b_{3i}}$), o vėliau mažėja.  
(b) atveju – atvirkščiai.

Diskriptyvinei analizei panaudota lentelė su duomenų padėties charakteristikomis (vidurkis, standartinis nuokrypis, maksimalios ir minimalios reikšmės), boxplot, scatter, time series grafikai ir histogramos.  

Lentelės rodo didelius skirtumus tarp šalių energijos vartojimo ir CO$_2$ emisijų (pagal vidurkius išsiskiria Bahreinas ir Kataras dėl savo didelių EPC ir CO$_2$ lygių).  

Iš boxplot grafikų galima pastebėti, kad didesni EPC ir BVP rodikliai paprastai lemia CO$_2$ padidėjimą.  

Laiko eilučių grafikuose vaizduojami $LnCO_2$, $LnEPC$ ir $LnGDP$ kiekvienoje šalyje 1995–2014 m. Pastebima 2008 m. recesija visose šalyse, tačiau bendros išvados, tenkinančios visas šalis, padaryti negalima dėl skirtingų CO$_2$ augimo tendencijų.

---

### Daugiamatė regresinė analizė

Tiriant CO$_2$ emisijos ryšį su vienam gyventojui tenkančiu energijos suvartojimu, BVP ir $BVP^2$, septynioms MENA šalims 1995–2014 m. taikoma daugiamatė tiesinė regresija.  

Aiškinamieji kintamieji: $LnEPC$, $LnGDP$, $(LnGDP)^2$.  
Modelio tinkamumas: $R^2 = 0.99$, $F = 545$, vidutinė santykinė paklaida 1.8–4.7 %.  

Šalys suskirstytos:
- U formos kategorija: Alžyras, Bahreinas.  
- Apverstos U formos kategorija (patvirtinta EKC hipotezė): Omanas, Kataras, Saudo Arabija.  
- Neapibrėžti rezultatai: Iranas, Kuveitas.

---

### Daugiamatės regresijos prielaidos: 

Autoriai tikrina šias prielaidas: daugiamatį normalumą, autokoreliaciją, homoskedastiškumą ir kolineariškumą. Visi testai yra atlikti grafiškai.  

## Straipsnio tyrimo išvados:  

Apibendrinus, straipsnio autoriai pastebi, jog Omanas, Kataras ir Saudo Arabija skaičiavimų eigoje įgauna apverstos U-formos kreives. Šioms valstybėms turint mažesnę GDP reikšmę, nei jų lūžio taškas, ekonominis augimas lemia didesnes Co2 emisijas, tačiau GDP reikšmei tapus aukštesnei nei lūžio taško reikšmei – aplinkos kokybė gerėja kartu su ekonominiu augimu. Alžyras ir Bahreinas tyrimo eigoje įgauna U-formos kreives. Tai reiškia, kad GDP reikšmei tapus aukštesnei, nei jos lūžio taškas, ekonominis augimas lemia didesnes Co2 emisijas. Atitinkamai, straipsnio autoriai siūlo tinkamos ekonomikos ir socialinės politikos taikymą šioms valstybėms tam, kad būtų sumažintos Co2 emisijos, tuo pačiu metu gerinant ekonomikos augimą. Taip pat, rezultatai Iranui ir Kuveitui yra neapibrėžti. Šiuo atveju, straipsnio autoriai rekomenduoja pakeisti taikomus statistinius metodus, arba itraukti papildomus nepriklausomus kintamuosius, kurie suteiktų galimybę gauti tikslesnį rezultatą. 

---

# Darbas: 

Nagrinėti duomenys:  

Šaltinis: World Bank Development Indicators, WDI. Duomenys iš WDI buvo tiesiogiai įkelti į R aplinką naudojant WDI paketą. 

Struktūra: Surinkti duomenys apima 7 valstybes: Alžyrą, Bahreiną, Iraną, Kuveitą, Omaną, Katarą ir Saudo Arabiją. Filtruotas laikotarpis: 1995-2014 metai. Pasirinkti kintamieji: GDP per capita (current US), Carbon dioxide (CO2) emissions excluding LULUCF per capita (t CO2ecapita), Electric power consumption (kWh per capita). Kiekviena eilutė atitinka šalį ir konkretų laikotarpį. 

Dažnis: Metiniai duomenys. 

Reikšmių matavimai:  

GDP per capita (current US$) – matuojamas JAV doleriais vienam žmogui. 

Carbon dioxide (CO2) emissions excluding LULUCF (Land use, Land-use change and Forestry) per capita (t CO2e/capita) – CO2 emisijos, atskaičius žemės naudojimą, žemės naudojimo pokyčius ir miškininkystę, matuojamos tonomis vienam žmogui. Pasirinkome šį rodiklį, todėl nes WDI nebeteikia galimybės naudoti paprasto CO2 per capita rodiklio. 

Electric power consumption (kWh per capita) – Elektros energijos suvartojimas, matuojamas kilovatvalandėmis vienam gyventojui. 

Taikyti statistiniai metodai: 

Duomenų reikšmių pavertimas į natūrinio logaritmo reikšmes, taikytos empirinės charakteristikos (standartinis nuokrypis, mediana, min, max), atlikta išskirčių analizė (nubraižyti boxplot grafikai), nubraižyti trend, scatterplot grafikai.

```{r, echo=FALSE} 
MENA <- WDI(country = c('DZ', 'BH', 'IR', 'KW', 'OM', 'QA', 'SA'), indicator = c("EN.GHG.CO2.PC.CE.AR5", "NY.GDP.PCAP.CD", "EG.USE.ELEC.KH.PC"), start = 1995, end = 2014)
MENA <- rename(MENA, 'CO2 emission' =	'EN.GHG.CO2.PC.CE.AR5' , 'GDP per capita' = 'NY.GDP.PCAP.CD', 'EPC - Electric Power Consumption' = 'EG.USE.ELEC.KH.PC')
MENA <- select(MENA, country, year, `CO2 emission`, `GDP per capita`, `EPC - Electric Power Consumption`)
```

Grafikai:
  
```{r, echo=FALSE} 
empir <- MENA %>%
  mutate(`Ln(CO2)` = log(`CO2 emission`), `Ln(EPC)` = log(`EPC - Electric Power Consumption`), `Ln(GDP)` = log(`GDP per capita`))%>%
  group_by(country) %>%
  summarise(
    mean_LnCO2 = round(mean(`Ln(CO2)`), 2),
    std_LnCO2 = round(sd(`Ln(CO2)`), 2),
    min_LnCO2 = round(min(`Ln(CO2)`), 2),
    max_LnCO2 = round(max(`Ln(CO2)`), 2),
    
    mean_LnEPC = round(mean(`Ln(EPC)`), 2),
    std_LnEPC = round(sd(`Ln(EPC)`), 2),
    min_LnEPC = round(min(`Ln(EPC)`),2),
    max_LnEPC = round(max(`Ln(EPC)`), 2),
    
    mean_LnGDP = round(mean(`Ln(GDP)`), 2),
    std_LnGDP = round(sd(`Ln(GDP)`), 2),
    min_LnGDP = round(min(`Ln(GDP)`), 2),
    max_LnGDP = round(max(`Ln(GDP)`), 2)
  )
```

```{r fig.height=4, fig.width=6, echo=FALSE}
knitr::kable(empir, caption = "MENA šalių diskriptyvinė analizė")
```

```{r fig.height=4, fig.width=6, echo=FALSE}
MENA <- mutate(MENA, `Ln(CO2)` = log(`CO2 emission`), `Ln(EPC)` = log(`EPC - Electric Power Consumption`), `Ln(GDP)` = log(`GDP per capita`))
bxplt_CO2 <- ggplot(MENA, mapping = aes(x = country, y = `Ln(CO2)`))+
  geom_boxplot(
    color = 'blue',
    fill = 'white',
    outlier.colour = 'red',
    outlier.shape = 3,
    outlier.size = 2
    )+
  labs(
    x = "Country",
    y = "Ln(CO2)",
    title = "Natūralusis logaritmas nuo CO2 emisiju"
  )+
  theme_classic()
bxplt_CO2
```

```{r fig.height=4, fig.width=6, echo=FALSE}
bxplt_EPC <- ggplot(MENA, mapping = aes(x = country, y = `Ln(EPC)`))+
  geom_boxplot(
    color = 'blue',
    fill = 'white',
    outlier.colour = 'red',
    outlier.shape = 3,
    outlier.size = 2
  )+
  labs(
    x = 'Country',
    y = 'Ln(EPC)',
    title = 'Natūralusis logaritmas nuo Elektros energijos suvartojimo'
  )+
  theme_minimal()
bxplt_EPC
```

```{r fig.height=4, fig.width=6, echo=FALSE}
bxplt_GDP <- ggplot(MENA, mapping = aes(x = country, y = `Ln(GDP)`))+
  geom_boxplot(
    color = 'blue',
    fill = 'white',
    outlier.colour = 'red',
    outlier.shape = 3,
    outlier.size = 2
  )+
  labs(
    x = 'Country',
    y = 'Ln(GDP)',
    title = 'Natūralusis logaritmas nuo BVP'
  )+
  theme_minimal()
bxplt_GDP
```

```{r fig.height=4, fig.width=6, echo=FALSE}
pasiskirst_CO2 <- ggplot(MENA, mapping = aes(x = year, y = `Ln(CO2)`, shape = country))+
  geom_point()+
  scale_shape_manual(values = c(1, 2, 3, 4, 5, 6, 7)) +
  labs(
    x = 'year',
    y = 'Ln(CO2)',
    title = 'Naturalusis logaritmas nuo CO2 emisiju pagal metus'
  )
pasiskirst_CO2
```

```{r fig.height=4, fig.width=6, echo=FALSE}
pasiskirst_EPC <- ggplot(MENA, mapping = aes(x = year, y = `Ln(EPC)`, shape = country))+
  geom_point()+
  scale_shape_manual(values = c(1, 2, 3, 4, 5, 6, 7)) +
  labs(
    x = 'year',
    y = 'Ln(EPC)',
    title = 'Naturalusis logaritmas nuo Elektros enersijos suvartojimo pagal metus'
  )
pasiskirst_EPC
```

```{r fig.height=4, fig.width=6, echo=FALSE}
pasiskirst_GDP <- ggplot(MENA, mapping = aes(x = year, y = `Ln(GDP)`, shape = country))+
  geom_point()+
  scale_shape_manual(values = c(1, 2, 3, 4, 5, 6, 7)) +
  labs(
    x = 'year',
    y = 'Ln(GDP)',
    title = 'Naturalusis logaritmas nuo BVP pagal metus'
  )
pasiskirst_GDP
```

```{r fig.height=4, fig.width=6, echo=FALSE}
ggplot(MENA, mapping = aes(x = `Ln(EPC)`, y = `Ln(CO2)`))+
  geom_point()+
  labs(
    y = 'CO2 emissions'
  )
```

```{r fig.height=4, fig.width=6, echo=FALSE}
ggplot(MENA, mapping = aes(x = `Ln(GDP)`, y = `Ln(CO2)`))+
  geom_point()+
  labs(
    y = 'CO2 emissions'
  )

```
---

# Išvados: 

Pastebime, jog gauti atlikto darbo rezultatai turi panašumų su straipsnio autorių diskriptyvinės analizės metu gautais rezultatais: standartinio nuokrypio, vidurkio, min, max
reikšmės daugelyje vietų sutampa, boxplot grafikai atitinka straipsnio grafikus.